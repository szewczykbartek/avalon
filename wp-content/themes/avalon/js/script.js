var Floorplans = {
	"1": {
		"Name": "1",
		"Area1": "250 m<sup>2</sup>",
		"Area2": "175 m<sup>2</sup>",
		"Price1": "Rezerwacja",
		"Price2": "",
		"Floorplans": {
			"1": "FloorLeft1.png",
			"1small": "FloorLeft1Small.png",
			"2": "FloorLeft0.png",
			"2small": "FloorLeft0Small.png",
			"Pdf": "avalon-floor-plan.pdf"
		},
		"Sold": "true"
	},
	"2": {
		"Name": "2",
		"Area1": "246 m<sup>2</sup>",
		"Area2": "175 m<sup>2</sup>",
		"Price1": "985 000,00 zł",
		"Price2": "5 629 zł",
		"Floorplans": {
			"1": "FloorRight1.png",
			"1small": "FloorRight1Small.png",
			"2": "FloorRight0.png",
			"2small": "FloorRight0Small.png",
			"Pdf": "avalon-floor-plan.pdf"
		}
	},
	"3": {
		"Name": "3",
		"Area1": "246 m<sup>2</sup>",
		"Area2": "175 m<sup>2</sup>",
		"Price1": "985 000,00 zł",
		"Price2": "5 629 zł",
		"Floorplans": {
			"1": "FloorLeft1.png",
			"1small": "FloorLeft1Small.png",
			"2": "FloorLeft0.png",
			"2small": "FloorLeft0Small.png",
			"Pdf": "avalon-floor-plan.pdf"

		}
	},
	"4": {
		"Name": "4",
		"Area1": "247 m<sup>2</sup>",
		"Area2": "175 m<sup>2</sup>",
		"Price1": "985 000,00 zł",
		"Price2": "5 629 zł",
		"Floorplans": {
			"1": "FloorRight1.png",
			"1small": "FloorRight1Small.png",
			"2": "FloorRight0.png",
			"2small": "FloorRight0Small.png",
			"Pdf": "avalon-floor-plan.pdf"
		},
		"Sold": "reservation"
	},
	"5": {
		"Name": "5",
		"Area1": "248 m<sup>2</sup>",
		"Area2": "175 m<sup>2</sup>",
		"Price1": "Rezerwacja",
		"Price2": "",
		"Floorplans": {
			"1": "FloorLeft1.png",
			"1small": "FloorLeft1Small.png",
			"2": "FloorLeft0.png",
			"2small": "FloorLeft0Small.png",
			"Pdf": "avalon-floor-plan.pdf"

		},
		"Sold": "reservation"
	},
	"6": {
		"Name": "6",
		"Area1": "429 m<sup>2</sup>",
		"Area2": "175 m<sup>2</sup>",
		"Price1": "1 150 000,00 zł",
		"Price2": "6 571 zł",
		"Floorplans": {
			"1": "FloorRight1.png",
			"1small": "FloorRight1Small.png",
			"2": "FloorRight0.png",
			"2small": "FloorRight0Small.png",
			"Pdf": "avalon-floor-plan.pdf"

		}
	},
	"7": {
		"Name": "7",
		"Area1": "418 m<sup>2</sup>",
		"Area2": "175 m<sup>2</sup>",
		"Price1": "1 150 000,00 zł",
		"Price2": "6 571 zł",
		"Floorplans": {
			"1": "FloorLeft1.png",
			"1small": "FloorLeft1Small.png",
			"2": "FloorLeft0.png",
			"2small": "FloorLeft0Small.png",
			"Pdf": "avalon-floor-plan.pdf"

		},
		"Sold": "true"
	},
	"8": {
		"Name": "8",
		"Area1": "238 m<sup>2</sup>",
		"Area2": "175 m<sup>2</sup>",
		"Price1": "985 000,00 zł",
		"Price2": "5 629 zł",
		"Floorplans": {
			"1": "FloorRight1.png",
			"1small": "FloorRight1Small.png",
			"2": "FloorRight0.png",
			"2small": "FloorRight0Small.png",
			"Pdf": "avalon-floor-plan.pdf"

		}
	},
	"9": {
		"Name": "9",
		"Area1": "238 m<sup>2</sup>",
		"Area2": "175 m<sup>2</sup>",
		"Price1": "985 000,00 zł",
		"Price2": "5 629 zł",
		"Floorplans": {
			"1": "FloorLeft1.png",
			"1small": "FloorLeft1Small.png",
			"2": "FloorLeft0.png",
			"2small": "FloorLeft0Small.png",
			"Pdf": "avalon-floor-plan.pdf"

		}
	},
	"10": {
		"Name": "10",
		"Area1": "238 m<sup>2</sup>",
		"Area2": "175 m<sup>2</sup>",
		"Price1": "985 000,00 zł",
		"Price2": "5 629 zł",
		"Floorplans": {
			"1": "FloorRight1.png",
			"1small": "FloorRight1Small.png",
			"2": "FloorRight0.png",
			"2small": "FloorRight0Small.png",
			"Pdf": "avalon-floor-plan.pdf"
		},
		"Sold": "true"
	},
	"11": {
		"Name": "11",
		"Area1": "238 m<sup>2</sup>",
		"Area2": "175 m<sup>2</sup>",
		"Price1": "985 000,00 zł",
		"Price2": "5 629 zł",
		"Floorplans": {
			"1": "FloorLeft1.png",
			"1small": "FloorLeft1Small.png",
			"2": "FloorLeft0.png",
			"2small": "FloorLeft0Small.png",
			"Pdf": "avalon-floor-plan.pdf"

		}
	},
	"12": {
		"Name": "12",
		"Area1": "238 m<sup>2</sup>",
		"Area2": "175 m<sup>2</sup>",
		"Price1": "985 000,00 zł",
		"Price2": "5 629 zł",
		"Floorplans": {
			"1": "FloorRight1.png",
			"1small": "FloorRight1Small.png",
			"2": "FloorRight0.png",
			"2small": "FloorRight0Small.png",
			"Pdf": "avalon-floor-plan.pdf"
		},
		"Sold": "true"
	},
};







var ControlPack;
var console = console || {
	"log": function () {}
};

var intCheckContents;


var wWindow, hWindow, wContent;


var mapArray = [];
var markerArray = [];

var drawArray = [];

var directionDisplay;
var directionsService = new google.maps.DirectionsService();

var sliderInterval;

var galleryPhotosArray = new Array();
var galleryPhotoSize1, galleryPhotoSize2, galleryPhotoSize3;


var scrollbarGalleryMosaicApi, scrollbarGalleryFullApi;


var grid1, grid2;

var markersArray;

$(document).ready(function () {

	function Control() {
		var self = this;

		$.extend(this, {
			Render: function () {

				// Design

				wWindow = $(window).width();
				hWindow = $(window).height();



				wContent = $(window).width() - 90;
				if ($(window).width() < 760)
					wContent = $(window).width();



				// Mobile / Pc / Tablet

				device = 'pcJS';
				if ($(window).width() < 1100)
					device = 'mobileJS tabletJS';
				if ($(window).width() < 760)
					device = 'mobileJS phoneJS';

				$('body').removeClass('mobileJS pcJS tabletJS phoneJS');
				$('body').addClass(device);

				$('.wWindow').width(wWindow);
				$('.hWindow').height(hWindow);
				$('.wContent').width(wContent);

				if ($(window).width() > 1100) {
					grid1 = Math.round(wContent / 4);
					grid2 = Math.round(wContent / 2) - 1;
					grid3 = Math.round((wContent / 4) * 3) - 1;
					grid4 = wContent - 1;
					grid1plus90 = grid1 + 90;
				} else {
					grid1 = wContent / 2;
					grid2 = wContent / 1;
					grid3 = (wContent / 4) * 3;
					grid4 = wContent;
					grid1plus90 = grid1 + 90;
				}

				$('.grid1plus90').width(grid1plus90);
				$('.grid1').outerWidth(grid1);
				$('.grid2').outerWidth(grid2);
				$('.grid3').outerWidth(grid3);


				$('#Menu').css('width', (90 + grid1));
				$('#Menu .More').css('left', -(grid1));


				$('.PhotoContainer').each(function () {
					$(this).find('.Photo').width($(this).closest('.Cl').width());
				})
				$('.MapContainer').each(function () {
					$(this).find('.Map').width($(this).closest('.Cl').width());
				})



				// Floorplans

				scale = $('.Page.Floorplans .View .Buildings').parent().height() / 1250;
				if ((2391 * scale) < $('.Page.Floorplans .View .Buildings').parent().width() - 90)
					scale = $('.Page.Floorplans .View .Buildings').parent().width() / 2391;
				if ($(window).width() < 760 && wWindow > hWindow)
					scale = $('.Page.Floorplans .View .Buildings').parent().width() / 2391;

				$('.Page.Floorplans .View .Buildings').css({
					'-webkit-transform': 'translateY(-50%) translateX(-50%) scale(' + scale + ')',
					'-moz-transform': 'translateY(-50%) translateX(-50%) scale(' + scale + ')',
					'transform': 'translateY(-50%) translateX(-50%) scale(' + scale + ')'
				});

				$('.Page.Floorplans .InfoBlocked.on').each(function () {
					building = $(this).data('building');
					$(this).css({
						'top': $('.Page.Floorplans .View .Buildings .Spot[data-building="' + building + '"]').css('top'),
						'left': $('.Page.Floorplans .View .Buildings .Spot[data-building="' + building + '"]').css('left'),
						'-webkit-transform': 'translateY(-50%) translateX(-50%) scale(' + (1 / scale) + ')',
						'-moz-transform': 'translateY(-50%) translateX(-50%) scale(' + (1 / scale) + ')',
						'transform': 'translateY(-50%) translateX(-50%) scale(' + (1 / scale) + ')'
					})
				})





				// Safari

				$('body.safari .Page.Gallery .View.Mosaic .Items').height(hWindow * 0.6)
				$('body.safari .Page.Floorplans .View.Floors .Floor').width(wWindow - 90 - (wWindow - 90) / 4)



				// Map

				$.each(mapArray, function (index, value) {
					google.maps.event.trigger(value, 'resize');
				})


				// Vector
				urlArray = location.href.split("/");
				slugLast = urlArray[(urlArray.length - 2)];

				if (slugLast == 'avalon') {

					pTopLeft = '0,0 ';
					pTopCenter = wWindow / 2 + ',0 ';
					pTopRight = wWindow + ',0 ';

					p70Left = '0,' + hWindow * 0.75 + ' ';
					p30Right = wWindow + ',' + hWindow * 0.25 + ' ';

					pBottomLeft = '0,' + hWindow + ' ';
					pBottomCenter = (wWindow / 2) + ',' + hWindow + ' ';
					pBottomRight = wWindow + ',' + hWindow + ' ';

					mTopLeft = ($('.Menu').offset().left - 1) + ',' + ($('.Menu').offset().top - 1) + ' ';
					mTopCenter = (($('.Menu').offset().left) + $('.Menu').width() / 2) + ',' + ($('.Menu').offset().top - 1) + ' ';
					mTopRight = (($('.Menu').offset().left + 1) + $('.Menu').width()) + ',' + ($('.Menu').offset().top - 1) + ' ';
					mBottomLeft = ($('.Menu').offset().left - 1) + ',' + ($('.Menu').offset().top + $('.Menu').height() + 1) + ' ';
					mBottomCenter = (($('.Menu').offset().left) + $('.Menu').width() / 2) + ',' + ($('.Menu').offset().top + $('.Menu').height() + 1) + ' ';
					mBottomRight = (($('.Menu').offset().left + 1) + $('.Menu').width()) + ',' + ($('.Menu').offset().top + $('.Menu').height() + 1) + ' ';

					$('.Page.Home .Vector svg').attr('width', wWindow)
					$('.Page.Home .Vector svg').attr('height', hWindow)
					$('.Page.Home .Vector svg').attr('viewBox', '0 0 ' + wWindow + ' ' + hWindow)

					$('.Page.Home .Vector svg path.Path1').attr('d', 'M' + mTopCenter + mTopLeft + mBottomLeft + p70Left + pTopLeft + pTopCenter)
					$('.Page.Home .Vector svg path.Path2').attr('d', 'M' + mTopRight + mTopCenter + pTopCenter + pTopRight + p30Right + mTopRight)
					$('.Page.Home .Vector svg path.Path3').attr('d', 'M' + mBottomLeft + mBottomCenter + pBottomCenter + pBottomLeft + p70Left + mBottomLeft)
					$('.Page.Home .Vector svg path.Path4').attr('d', 'M' + mBottomCenter + mBottomRight + mTopRight + p30Right + pBottomRight + pBottomCenter + mBottomCenter)


				}

				// Gallery

				// Gallery mosaic

				galleryPad = 50;
				if ($(window).width() < 760)
					galleryPad = 24;
				galleryPhotosArray = new Array();
				if (wContent < 900) {
					galleryPhotoSize1 = (wContent - galleryPad * 3) / 1.5;
					galleryPhotoSize2 = galleryPhotoSize1 * 0.7;
				}
				if (wContent > 900 && wContent < 1300) {
					galleryPhotoSize1 = (wContent - galleryPad * 3) / 2.5;
					galleryPhotoSize2 = galleryPhotoSize1 * 0.7;
				}
				if (wContent > 1300) {
					galleryPhotoSize1 = (wContent - galleryPad * 3) / 3.5;
					galleryPhotoSize2 = galleryPhotoSize1 * 0.7;
				}

				galleryContainerSize1 = galleryPhotoSize1;
				galleryContainerSize2 = galleryPhotoSize1 + galleryPhotoSize2 + galleryPad;
				galleryContainerSize3 = galleryPhotoSize1 + galleryPad;

				$('.galleryPhotoSize1').width(galleryPhotoSize1);
				$('.galleryPhotoSize2').width(galleryPhotoSize2);
				$('.galleryContainerSize1').width(galleryContainerSize1);
				$('.galleryContainerSize2').width(galleryContainerSize2);
				$('.galleryContainerSize3').width(galleryContainerSize3);

				galleryPhotosArray.push(0);
				galleryPhotosArray.push(galleryPhotoSize1 + 50);
				galleryPhotosArray.push(galleryPhotoSize1 + galleryPhotoSize2 + 100);
				galleryPhotosArray.push(galleryPhotoSize1 + galleryPhotoSize2 + galleryPhotoSize1 + 150);
				galleryPhotosArray.push(galleryPhotoSize1 + galleryPhotoSize2 + galleryPhotoSize1 + galleryPhotoSize1 + 200);
				galleryPhotosArray.push(galleryPhotoSize1 + galleryPhotoSize2 + galleryPhotoSize1 + galleryPhotoSize1 + galleryPhotoSize2 + 250);
				galleryPhotosArray.push(galleryPhotoSize1 + galleryPhotoSize2 + galleryPhotoSize1 + galleryPhotoSize1 + galleryPhotoSize2 + galleryPhotoSize1 + 300);

				if (wWindow > 1100) {
					$('.scrollbarGalleryMosaic .overview').width(0)
				} else {
					wItemsScroll = 10;
					$('.Page.Gallery .View.Mosaic .Items .Cl').each(function () {
						wItemsScroll += $(this).outerWidth(true);
					})
					$('.scrollbarGalleryMosaic .overview').width(wItemsScroll)

					if (scrollbarGalleryMosaicApi)
						scrollbarGalleryMosaicApi.update('relative');
				}

				// Gallery full

				$('.Page.Gallery .View.Full .Photo').each(function () {
					if (wWindow < 1100) {
						wPhoto = hWindow * Number($(this).data('ratio'));
					} else {
						wPhoto = hWindow * Number($(this).data('ratio'));
						if (wPhoto > wContent * 0.8) {
							wPhoto = wContent * 0.8;
						}
					}
					$(this).width(wPhoto);
				})

				if (wWindow > 1100) {
					$('.scrollbarGalleryFull .overview').width(0)
				} else {
					wItemsFullScroll = 10;
					$('.Page.Gallery .View.Full .Items .Photo').each(function () {
						wItemsFullScroll += $(this).width();
					})
					$('.scrollbarGalleryFull .overview').width(wItemsFullScroll)
					1
					if (scrollbarGalleryFullApi)
						scrollbarGalleryFullApi.update('relative');
				}

				// Contact

				textareaHeight = hWindow / 2 - 300;
				if (textareaHeight < 60)
					textareaHeight = 60;
				if (textareaHeight > 300)
					textareaHeight = 300;
				$('.Page.Contact form textarea').height(textareaHeight)


			},
			LoadPage: function (addressNew) {

				// Step 1 - load first images

				loadCount = loadCountFinal = 0;
				$('*:not(.noPreload_XXX)').each(function () {
					if ($(this).css('background-image') != 'none' && $(this).css('background-image').search('linear-gradient') == -1) {
						src = $(this).css('background-image').replace(/(^url\()|(\)$|[\"\'])/g, '');
						$(this).after('<img class="imgLoad" data-imgId="' + loadCount + '" src="' + src + '" />')

						$('.imgLoad[data-imgId="' + loadCount + '"]').load(function () {
							$(this).remove();
							loadCountFinal--;

							if (loadCountFinal == 0)
								loadEnd();
						});

						loadCount++;
						loadCountFinal++;

            return false;
					}
				})
				if (loadCountFinal == 0)
					loadEnd();

				// Step 2

				function loadEnd() {
					$('#Contents .Content[data-loaded!="true"]').each(function () {
						var template = $(this).data('template');
						$.ajax({
							type: "GET",
							url: domainTemplate + '/action/loadPage.php',
							data: {
								slug: template
							}
						}).done(function (msg) {
							$('#Contents .Content[data-template="' + template + '"]').append(msg);
							$('#Contents .Content[data-template="' + template + '"]').attr('data-loaded', 'true');
						});
					})

					function funcCheckContents() {
						request = false;
						$('#Contents .Content[data-loaded!="true"]').each(function () {
							request = true;
						})
						if (request == false) {
							clearInterval(intCheckContents);

							//
							// STEP 3 - End
							//

							$('body').removeClass('LoaderStart')
							$('body').addClass('Loaded')


							setTimeout(function () {
								$('.Page.Home .Menu').addClass('can')
							}, 2000);

							self.PageFunctionStart();
						}
					}
					intCheckContents = setInterval(function () {
						funcCheckContents();
					}, 100);

				}


			},
			PageTransition: function (content, template) {
				if (!$('body').hasClass('animNone')) {
					for (ii = $('#Contents .Content[data-active="active"] .animBoxOrder').length; ii >= 0; ii--) {
						function removeShow(ii, time) {
							setTimeout(function () {
								$('#Contents .Content[data-active="active"] .animBoxOrder[data-animBoxOrder="' + ii + '"]').removeClass('show');
							}, time);
						}
						removeShow(ii, (ii * 150));
					}
				}

				t1 = 600;
				t2 = 200;
				t3 = 1500;
				if ($('body').hasClass('mobileJS')) {
					t1 = 10;
					t2 = 10;
					t3 = 1000;
				}

				if ($('body').hasClass('animNone')) {
					t1 = t2 = t3 = 0;
				}

				setTimeout(function () {
					$('body').attr('data-content', content);

					$('#Menu a').removeClass('active')
					$('#Menu a[data-content="' + content + '"]').addClass('active');

					$('#Menu .Status div').removeClass('active')
					$('#Menu .Status div[data-content="' + content + '"]').addClass('active');

					$('#Contents .Content').attr('data-active', '')
					$('#Contents .Content[data-content="' + content + '"]').attr('data-active', 'active');

					for (i = 0; i <= $('#Contents .Content[data-active="active"] .animBoxOrder').length - 1; i++) {
						function addShow(i, time) {
							setTimeout(function () {
								$('#Contents .Content[data-active="active"] .animBoxOrder[data-animBoxOrder="' + i + '"]').addClass('show');
							}, time);
						}
						addShow(i, (i * t2) + t1);
					}
					$('#Contents .Content[data-active="active"] .animBox').each(function (key) {
						function addShow(t, time) {
							setTimeout(function () {
								t.addClass('show');
							}, time);
						}
						t = $(this);
						addShow(t, (key * t2) + t1);
					})

					self.Render();
					self.PageFunction();
					self.MapEffect('start');

				}, t3);

				setTimeout(function () {
					$('body').removeClass('animNone');
				}, 1000);
			},
			SlidersPos: function () {

				// Mosaic
				posMosaic = $('.Page.Gallery .View.Mosaic .Items').attr('data-pos');
				if (wContent > 1010) {
					$('.Page.Gallery .View.Mosaic .Items').css('left', -galleryPhotosArray[posMosaic]);
				} else {
					$('.Page.Gallery .View.Mosaic .ItemsScroll').animate({
						scrollLeft: galleryPhotosArray[posMosaic]
					}, 800);
				}

				// Full

				posMosaic = $('.Page.Gallery .View.Full .Items').attr('data-pos');
				$('.Page.Gallery .View.Full .Items .Photo').removeClass('active')
				$('.Page.Gallery .View.Full .Items .Photo').eq(posMosaic).addClass('active')

				left = $('.Page.Gallery .View.Full .Photo').eq(posMosaic).position().left;
				wPhoto = $('.Page.Gallery .View.Full .Photo').eq(posMosaic).width();


				leftNew = left;
				leftNew = left - (wContent - wPhoto) / 2;

				$('.Page.Gallery .View.Full .Items').css('left', -leftNew);

			},
			MapEffect: function (action) {
				$.each(mapArray, function (index, value) {
					google.maps.event.trigger(value, "resize");

					latIndex = centerlat = Number($(mapArray[index]['__gm']['W'].closest('.MapContainer')).attr('data-center-lat'));
					lngIndex = centerlng = Number($(mapArray[index]['__gm']['W'].closest('.MapContainer')).attr('data-center-lng'));

					mapCenter = new google.maps.LatLng({
						lat: latIndex,
						lng: lngIndex
					});
					value.setCenter(mapCenter)

					if (action == 'start') {
						markerArray[index].setAnimation(google.maps.Animation.BOUNCE);
						funcMarkerStop(markerArray[index]);

						function funcMarkerStop(markerOne) {
							window.setTimeout(function () {
								markerOne.setAnimation(null);
							}, 3000);
						}
					}
				})

			},
			PageFunctionStart: function () {

				// Pc
				mouseenter = 'mouseenter';
				mouseleave = 'mouseleave';


				$('.Areamap').maphilight({
					fillColor: '000000',
					fillOpacity: 0.5,
					stroke: false
				});


				$(document).on('mousemove', 'body', function (event) {
					if ($('body').hasClass('pcJS')) {
						if ($('#Contents .Content[data-template="home"]').attr('data-active') != 'active') {
							if (event.pageX < 90) {
								$('#Menu').removeClass('menuClose');
								$('body').addClass('menuOpen');
								$('#Menu').removeClass('hide');
							}
							if (event.pageX > (wContent / 4 + 90) && $('body').hasClass('menuOpen')) {
								if ($('body').attr('data-content-actual') != 'strona-glowna') {
									$('body').removeClass('menuOpen');
									$('body').addClass('menuClose');
									$('#Menu').addClass('hide');
									setTimeout(function () {
										$('body').removeClass('menuClose');
									}, 500);
								}
							}
						}
					}
				})

				$(document).on('click', '#Menu .Step1', function (event) {
					if (!$('body').hasClass('pcJS')) {
						$('#Menu').removeClass('menuClose');
						$('body').addClass('menuOpen');
						$('#Menu').removeClass('hide');
					}
				})
				$(document).on('click', '#Menu .Mask', function (event) {
					if (!$('body').hasClass('pcJS')) {
						$('body').removeClass('menuOpen');
						$('body').addClass('menuClose');
						$('#Menu').addClass('hide');

						setTimeout(function () {
							$('body').removeClass('menuClose');
						}, 500);
					}
				})


				// Start position page

				urlArray = History.getState().url.split("/");
				slugLast = urlArray[(urlArray.length - 2)];

				if (slugLast == 'avalonresidence.pl' || slugLast == 'avalon.hypotheticalpeople.com')
					slugLast = 'strona-glowna'

				self.PageTransition(slugLast);

				// Draw

				drawLine = function (id, delay, speed) {
					id = $('#' + id);
					var path = id.get(0);
					var lengthPath = path.getTotalLength();

					path.style.transition = path.style.WebkitTransition = 'none';
					path.style.strokeDasharray = lengthPath + ' ' + lengthPath;
					path.style.strokeDashoffset = lengthPath;
					path.getBoundingClientRect();

					id.show();
					path.style.transition = path.style.WebkitTransition = 'stroke-dashoffset ' + speed + 'ms linear';

					setTimeout(function () {
						path.style.strokeDashoffset = '0';
					}, delay);
				}

				drawArray = new Array();
				$('path.Draw').each(function (el) {
					$(this).attr('id', 'draw' + el)
					drawId = 'draw' + el;
					if (drawArray.indexOf(drawId) == -1)
						drawArray.push(drawId);
					drawLine(drawId, 2000, 4000);
				})



				//
				// Floorplans
				//

				FloorplansData('all', 'Render')

				function FloorplansData(building, action) {
					if (action == 'Render') {
						$.each(Floorplans, function (index, value) {

							if (value['Sold'] == 'true' || value['Sold'] == 'reservation') {
								InfoBlocked = $('.InfoBlocked').clone();
								InfoBlocked.addClass('on').end();

								if (value['Sold'] == 'reservation')
									InfoBlocked.find('.Text').html('Zarezerwowany');
								if (value['Sold'] == 'true')
									InfoBlocked.find('.Text').html('Sprzedany');

								InfoBlocked.attr('data-building', index).end();
								$('.Page.Floorplans .View.Buildings .Buildings').append(InfoBlocked)

								$('.Page.Floorplans .View.Buildings area[data-building="' + index + '"]').data('maphilight', {
									'alwaysOn': true,
									'fillColor': '000000',
									'fillOpacity': '0.5',
									'stroke': false,
									'status': 'off'
								});
							}else {
                $('.Page.Floorplans .View.Buildings area[data-building="' + index + '"]').data('maphilight', {
									'fillColor': '000000',
									'fillOpacity': '0.5',
									'stroke': false
								});
							}
						})
            $('.Areamap').maphilight();
					}

					if (action == 'Data') {
						$('.Page.Floorplans .BuildingData .Title').html(Floorplans[building]['Name']);
						$('.Page.Floorplans .BuildingData .Data[data-type="Area1"] .Value').html(Floorplans[building]['Area1']);
						$('.Page.Floorplans .BuildingData .Data[data-type="Area2"] .Value').html(Floorplans[building]['Area2']);
						if (Floorplans[building]['Price1'] != 'Rezerwacja') {
							$('.Page.Floorplans .BuildingData .Data[data-type="Price1"]').show();
							$('.Page.Floorplans .BuildingData .Data[data-type="Price2"]').show();
							$('.Page.Floorplans .BuildingData .Reservation').hide();
							$('.Page.Floorplans .BuildingData .Data[data-type="Price1"] .Value').html(Floorplans[building]['Price1']);
							$('.Page.Floorplans .BuildingData .Data[data-type="Price2"] .Value').html(Floorplans[building]['Price2']);
						} else {
							$('.Page.Floorplans .BuildingData .Data[data-type="Price1"]').hide();
							$('.Page.Floorplans .BuildingData .Data[data-type="Price2"]').hide();
							$('.Page.Floorplans .BuildingData .Reservation').show();
						}

						$('.Page.Floorplans .BuildingData').removeClass('active');
						$('.Page.Floorplans .BuildingData').addClass('end');
						window.setTimeout(function () {
							$('.Page.Floorplans .BuildingData').removeClass('end');
							$('.Page.Floorplans .BuildingData').addClass('start active');
							window.setTimeout(function () {
								$('.Page.Floorplans .BuildingData').removeClass('start end');
							}, 100);
						}, 100);
					}

					if (action == 'Floor') {
						image1 = Floorplans[building]['Floorplans']['1'];
						if ($(window).width() < 760)
							image1 = Floorplans[building]['Floorplans']['1small'];
						$('.Page.Floorplans .View.Floors .Floor[data-floor="1"] img').attr('src', domainTemplate + '/assets/floorplans/' + image1);
						$('.Page.Floorplans .View.Floors .Floor[data-floor="1"] img').bind('load', function () {
							$('.Page.Floorplans .View.Floors .Floor[data-floor="1"] img').unbind('load')
							$('.Page.Floorplans .View.Floors .Floor[data-floor="1"] .Background').css('background-image', 'url(' + domainTemplate + '/assets/floorplans/' + image1 + ')');
						});

						image2 = Floorplans[building]['Floorplans']['2'];
						if ($(window).width() < 760)
							image2 = Floorplans[building]['Floorplans']['2small'];
						$('.Page.Floorplans .View.Floors .Floor[data-floor="2"] img').attr('src', domainTemplate + '/assets/floorplans/' + image2);
						$('.Page.Floorplans .View.Floors .Floor[data-floor="2"] img').bind('load', function () {
							$('.Page.Floorplans .View.Floors .Floor[data-floor="2"] img').unbind('load')
							$('.Page.Floorplans .View.Floors .Floor[data-floor="2"] .Background').css('background-image', 'url(' + domainTemplate + '/assets/floorplans/' + image2 + ')');
						});

						pdf = domainTemplate + '/assets/floorplans/' + Floorplans[building]['Floorplans']['Pdf'];
						$('.Page.Floorplans .Bottom .DownloadPdf .Bt').attr('href', pdf);
					}
				}

				$(document).on('click', '.actFloorplansZoomChange', function (event) {
					if (!$('.Page.Floorplans .View.Floors').hasClass('zoomOn')) {
            $('.Page.Floorplans .View.Floors').addClass('zoomOn')
    					$('.Page.Floorplans .View.Floors .Zoom').addClass('on');

						$('.pcJS .Page.Floorplans .View.Floors .Floor[data-floor="1"]').zoom({
							magnify: 0.6,
							onZoomIn: function () {
								$('.Floor').addClass('onZoom');
							},
							onZoomOut: function () {
								$('.Floor').removeClass('onZoom');
							}
						});
						$('.pcJS .Page.Floorplans .View.Floors .Floor[data-floor="2"]').zoom({
							magnify: 1,
							onZoomIn: function () {
								$('.Floor').addClass('onZoom');
							},
							onZoomOut: function () {
								$('.Floor').removeClass('onZoom');
							}
						});

					} else {

            $('.Page.Floorplans .View.Floors').removeClass('zoomOn')
    					$('.Page.Floorplans .View.Floors .Zoom').removeClass('on');

						$('.pcJS .Page.Floorplans .View.Floors .Floor[data-floor="1"]').trigger('zoom.destroy');
						$('.pcJS .Page.Floorplans .View.Floors .Floor[data-floor="2"]').trigger('zoom.destroy');
					}
				})



				$(document).on('mouseenter touchstart', '.actFloorplansChangeBuilding', function (event) {
					building = $(this).data('building');
					FloorplansData(building, 'Data')
				})

				$(document).on('click', '.actFloorplansChangeFloor', function (event) {
					floor = $(this).data('floor');
					$('.Page.Floorplans .Floors .Bt').removeClass('active');
					$('.Page.Floorplans .Floors .Bt[data-floor="' + floor + '"]').addClass('active');

					$('.Page.Floorplans .View.Floors .Floor').removeClass('active');
					$('.Page.Floorplans .View.Floors .Floor[data-floor="' + floor + '"]').addClass('active');

					$('.Page.Floorplans').scrollTop(0)
				})


				$(document).on('touchstart', '.actFloorplansStep1', function (event) {
					$('.Page.Floorplans').attr('data-step', '1');
				})
				$(document).on('touchstart', '.actFloorplansStep2', function (event) {
					$('.Page.Floorplans').attr('data-step', '2');
				})
				$(document).on('touchstart', '.actFloorplansStep3', function (event) {
					$('.Page.Floorplans').attr('data-step', '3');
				})




				$(document).on('click touchend', '.actFloorplansViewFloors', function (event) {
					if (!$('body').hasClass('phoneJS') && $(this)[0].nodeName == 'AREA') {
						if (!$('.Page.Floorplans').hasClass('anim')) {
							$('.Page.Floorplans').addClass('anim');

							building = $(this).data('building');
							FloorplansData(building, 'Floor');

							$('.Page.Floorplans').attr('data-view', 'Floors');
							$('.Page.Floorplans .View.Buildings').removeClass('active');
							$('.Page.Floorplans .View.Floors').addClass('active');
							$('.Page.Floorplans').removeClass('anim');
						}
					}


					if ($('body').hasClass('phoneJS') && $(this)[0].nodeName == 'DIV') {
						$('.Page.Floorplans').addClass('anim');

						FloorplansData('1', 'Floor')

						$('.Page.Floorplans').attr('data-view', 'Floors');
						$('.Page.Floorplans .View.Buildings').removeClass('active');
						$('.Page.Floorplans .View.Floors').addClass('active');

						$('.Page.Floorplans .View.Buildings').addClass('pt-page-scaleDown');
						$('.Page.Floorplans .View.Floors').addClass('pt-page-scaleUpDown pt-page-delay300');
						setTimeout(function () {
							$('.Page.Floorplans .View.Buildings').removeClass('pt-page-scaleDown');
							$('.Page.Floorplans .View.Floors').removeClass('pt-page-scaleUpDown pt-page-delay300');

							$('.Page.Floorplans').removeClass('anim');
						}, 2000);

					}
				});
				$(document).on('click touchstart', '.actFloorplansViewBuildings', function (event) {
					if (!$('.Page.Floorplans').hasClass('anim')) {
						$('.Page.Floorplans').addClass('anim');

						$('.Page.Floorplans .View.Floors .Zoom').removeClass('on');

						$('.Page.Floorplans').attr('data-view', 'Buildings');
						setTimeout(function () {}, 2000);
						$('.Page.Floorplans .View.Floors').removeClass('active');
						$('.Page.Floorplans .View.Buildings').addClass('active');


						$('.pcJS .Page.Floorplans .View.Floors .Floor[data-floor="1"] img.zoomImg').remove();
						$('.pcJS .Page.Floorplans .View.Floors .Floor[data-floor="1"]').trigger('zoom.destroy');

						$('.pcJS .Page.Floorplans .View.Floors .Floor[data-floor="2"] img.zoomImg').remove();
						$('.pcJS .Page.Floorplans .View.Floors .Floor[data-floor="2"]').trigger('zoom.destroy');

						$('.Page.Floorplans').removeClass('anim');
					}
				});


				// Developer

				$(document).on('mouseenter', '.Slider', function (event) {
					$(this).addClass('hover');
				})
				$(document).on('mouseleave', '.Slider', function (event) {
					$(this).removeClass('hover');
				})

				$(document).on('click', '.actSliderChange', function (event) {
					i = $(this).index();
					$(this).closest('.Slider').find('.SliderNav a').removeClass('active');
					$(this).closest('.Slider').find('.SliderNav a').eq(i).addClass('active');
					$(this).closest('.Slider').find('.SliderItem').removeClass('active');
					$(this).closest('.Slider').find('.SliderItem').eq(i).addClass('active');
				})
				$(document).on('click', '.actSliderArrowChange', function (event) {
					$(this).closest('.Slider').addClass('stop');

					i = $(this).closest('.Slider').find('.SliderNav a.active').index();
					iMax = $(this).closest('.Slider').find('.SliderNav a').length - 1;
					if ($(this).hasClass('Prev')) {
						i--;
						if (i < 0)
							i = iMax;
					}
					if ($(this).hasClass('Next')) {
						i++;
						if (i > iMax)
							i = 0;
					}
					$(this).closest('.Slider').find('.SliderNav a').removeClass('active');
					$(this).closest('.Slider').find('.SliderNav a').eq(i).addClass('active');
					$(this).closest('.Slider').find('.SliderItem').removeClass('active');
					$(this).closest('.Slider').find('.SliderItem').eq(i).addClass('active');
				})


				$('.Slider').swipeend(function (e, touch) {
					if (!$('body').hasClass('pcJS')) {
						$(this).addClass('stop');
						i = $(this).find('.SliderNav a.active').index();
						iMax = $(this).find('.SliderNav a').length - 1;
						if (touch.direction == 'left') {
							i++;
							if (i > iMax)
								i = 0;
							$(this).closest('.Slider').find('.SliderNav a').removeClass('active');
							$(this).closest('.Slider').find('.SliderNav a').eq(i).addClass('active');
							$(this).closest('.Slider').find('.SliderItem').removeClass('active');
							$(this).closest('.Slider').find('.SliderItem').eq(i).addClass('active');

						}
						if (touch.direction == 'right') {
							i--;
							if (i < 0)
								i = iMax;
							$(this).closest('.Slider').find('.SliderNav a').removeClass('active');
							$(this).closest('.Slider').find('.SliderNav a').eq(i).addClass('active');
							$(this).closest('.Slider').find('.SliderItem').removeClass('active');
							$(this).closest('.Slider').find('.SliderItem').eq(i).addClass('active');
						}
					}
				});

				sliderInterval = setInterval(function () {
					$('.Slider:not(.hover):not(.stop)').each(function (key) {
						i = $(this).find('.SliderNav a.active').index();
						iMax = $(this).find('.SliderNav a').length - 1;
						i++;
						if (i > iMax)
							i = 0;
						$(this).closest('.Slider').find('.SliderNav a').removeClass('active');
						$(this).closest('.Slider').find('.SliderNav a').eq(i).addClass('active');
						$(this).closest('.Slider').find('.SliderItem').removeClass('active');
						$(this).closest('.Slider').find('.SliderItem').eq(i).addClass('active');
					})
				}, 9000);


				$(document).on('click', '.actSliderFull', function (event) {
					if (!$('body').hasClass('phoneJS')) {
						src = $(this).data('src-full');
						$('#SliderFull').css('background-image', 'url(' + domainTemplate + '/' + src + ')')
						$('#SliderFull').addClass('open');
					}
				})
				$(document).on('click', '.actSliderFullClose', function (event) {
					$('#SliderFull').css('background-image', 'url()')
					$('#SliderFull').removeClass('open');
				})


				// Gallery

				// Mosaic

				if ($('body').hasClass('computer')) {
					scrollbarGalleryMosaic = $('.scrollbarGalleryMosaic');
					scrollbarGalleryMosaic.tinyscrollbar({
						axis: 'x',
						scrollInvert: true
					});
					scrollbarGalleryMosaicApi = $('.scrollbarGalleryMosaic').data("plugin_tinyscrollbar");
				}
				if (scrollbarGalleryMosaicApi)
					scrollbarGalleryMosaicApi.update('relative');




				$(document).on('click', '.actGalleryViewFull', function (event) {
					if (!$('.Page.Gallery').hasClass('anim')) {
						$('.Page.Gallery').addClass('anim');

						pos = $(this).attr('data-pos')

						$('.Page.Gallery .View.Full .Items').attr('data-pos', pos);
						self.SlidersPos();

						$('.Page.Gallery').attr('data-mode', 'full');

						$('.Page.Gallery .View.Full').addClass('active');

						$('.Page.Gallery .View.Mosaic').addClass('pt-page-scaleDown');
						$('.Page.Gallery .View.Full').addClass('pt-page-scaleUpDown pt-page-delay300');
						setTimeout(function () {
							$('.Page.Gallery .View.Mosaic').removeClass('active');
							$('.Page.Gallery .View.Mosaic').removeClass('pt-page-scaleDown');
							$('.Page.Gallery .View.Full').removeClass('pt-page-scaleUpDown pt-page-delay300');

							$('.Page.Gallery').removeClass('anim');
						}, 1500);
					}
				});

				$(document).on('click', '.Page.Gallery .View.Mosaic .Nav a', function (event) {
					pos = $('.Page.Gallery .View.Mosaic .Items').attr('data-pos');
					if (wContent > 1300)
						posMax = 5;
					else
						posMax = 6;

					if ($(this).hasClass('Prev'))
						pos--;
					if ($(this).hasClass('Next'))
						pos++;

					if (pos < 0)
						pos = 0;
					if (pos > posMax)
						pos = posMax;

					$(this).addClass('anim');
					setTimeout(function () {
						$('.Page.Gallery .View.Mosaic .Nav a').removeClass('anim');
					}, 300);

					$('.Page.Gallery .View.Mosaic .Items').attr('data-pos', pos);
					self.SlidersPos();
				})

				$('.Page.Gallery .View.Mosaic').mousewheel(function (event, delta) {
					if ($('body').hasClass('pcJS')) {
						if (!$(this).hasClass('anim')) {
							$('.Page.Gallery .View.Mosaic').addClass('anim');
							pos = $('.Page.Gallery .View.Mosaic .Items').attr('data-pos');
							if (wContent > 1300)
								posMax = 5;
							else
								posMax = 6;

							if (delta > 0)
								pos--;
							if (delta < 0)
								pos++;
							if (pos < 0)
								pos = 0;
							if (pos > posMax)
								pos = posMax;
							$('.Page.Gallery .View.Mosaic .Items').attr('data-pos', pos);
							self.SlidersPos();

							setTimeout(function () {
								$('.Page.Gallery .View.Mosaic').removeClass('anim');
							}, 350);
						}
					}
				});



				// Full

				if ($('body').hasClass('computer')) {
					scrollbarGalleryFull = $('.scrollbarGalleryFull');
					scrollbarGalleryFull.tinyscrollbar({
						axis: 'x',
						scrollInvert: true
					});
					scrollbarGalleryFullApi = $('.scrollbarGalleryFull').data("plugin_tinyscrollbar");
				}
				if (scrollbarGalleryFullApi)
					scrollbarGalleryFullApi.update('relative');

				$(document).on('click', '.actGalleryViewMosaic', function (event) {
					if (!$('.Page.Gallery').hasClass('anim')) {
						$('.Page.Gallery').addClass('anim');

						$('.Page.Gallery').attr('data-mode', 'mosaic');

						$('.Page.Gallery .View.Mosaic').addClass('active');

						$('.Page.Gallery .View.Mosaic').addClass('pt-page-scaleUp pt-page-delay300');
						$('.Page.Gallery .View.Full').addClass('pt-page-scaleDownUp');
						setTimeout(function () {
							$('.Page.Gallery .View.Full').removeClass('active');

							$('.Page.Gallery .View.Mosaic').removeClass('pt-page-scaleUp pt-page-delay300');
							$('.Page.Gallery .View.Full').removeClass('pt-page-scaleDownUp');

							$('.Page.Gallery').removeClass('anim');
						}, 1500);
					}
				});

				$(document).on('click', '.Page.Gallery .View.Full .Nav a', function (event) {
					pos = $('.Page.Gallery .View.Full .Items').attr('data-pos');
					posMax = $('.Page.Gallery .View.Full .Items .Photo').length - 1;
					if ($(this).hasClass('Prev'))
						pos--;
					if ($(this).hasClass('Next'))
						pos++;
					if (pos < 0)
						pos = 0;
					if (pos > posMax)
						pos = posMax;
					$('.Page.Gallery .View.Full .Items').attr('data-pos', pos);
					self.SlidersPos();
				})

				$('.Page.Gallery .View.Full').mousewheel(function (event, delta) {
					if ($('body').hasClass('pcJS')) {
						if (!$(this).hasClass('anim')) {
							$('.Page.Gallery .View.Full').addClass('anim');
							pos = $('.Page.Gallery .View.Full .Items').attr('data-pos');
							posMax = $('.Page.Gallery .View.Full .Items .Photo').length - 1;
							if (delta > 0)
								pos--;
							if (delta < 0)
								pos++;
							if (pos < 0)
								pos = 0;
							if (pos > posMax)
								pos = posMax;
							$('.Page.Gallery .View.Full .Items').attr('data-pos', pos);
							self.SlidersPos();

							setTimeout(function () {
								$('.Page.Gallery .View.Full').removeClass('anim');
							}, 350);
						}
					}
				});


				$(document).on('mousemove', '.Page.Gallery .View.Full .Nav a .Hover', function (event) {
					$(this).closest('a').find('.Icon').css({
						left: event.offsetX,
						top: event.offsetY
					})
				})

				$(".Page.Gallery .View.Full .Items").scroll(function () {
					$('.Page.Gallery .View.Full .Hint').fadeOut();
				});

				// Contact

				$(document).on('focus', 'input, textarea', function () {
					$(this).attr('placeholder', '');
				});

				$(document).on('blur', 'input, textarea', function () {
					dataPlaceHolder = $(this).attr('data-placeholder');
					$(this).attr('placeholder', dataPlaceHolder);
				});


				$('.Page.Contact form').validate({
					ignore: [],
					onkeyup: false,
					highlight: function (element, errorClass, validClass) {
						$(element).addClass('Error');
					},
					unhighlight: function (element, errorClass, validClass) {
						$(element).removeClass('Error');
					},
					submitHandler: function () {
						$('.Page.Contact form').hide();
						$('.Page.Contact .FormSuccess').show();

						$.ajax({
							type: "POST",
							url: domainTemplate + '/action/email.php',
							data: $('.Page.Contact form').serialize()
						}).done(function (html) {
						});
					}
				});



				// Maps / Contact

				$(document).on('click', '.actMapFullScreen', function (event) {
					$(this).closest('.MapContainer').toggleClass('fullScreen');

					$.each(mapArray, function (index, value) {
						google.maps.event.trigger(value, "resize");
					})
				});

				$(document).on('click', '.actMapTarget', function (event) {
					lat = Number($(this).attr('data-lat'));
					lng = Number($(this).attr('data-lng'));

					var request = {
						origin: new google.maps.LatLng(52.2189513, 21.1102093),
						destination: new google.maps.LatLng(lat, lng),
						travelMode: google.maps.DirectionsTravelMode.DRIVING
					};
					directionsService.route(request, function (response, status) {
						if (status == google.maps.DirectionsStatus.OK) {
							directionsDisplay.setDirections(response);
							var iconSequence = {
								icon: {
									fillColor: 'red',
									fillOpacity: 0.8,
									scale: 3,
									strokeColor: 'blue',
									strokeWeight: 1,
									strokeOpacity: 0.8,
									path: gm.SymbolPath.CIRCLE
								},
								repeat: '10px'
							};
							directionsDisplay.setDottedPolylineOptions(iconSequence);
						}
					});
				})

				$('.MapContainer').each(function (key) {

					lat = centerlat = Number($(this).attr('data-lat'));
					lng = centerlng = Number($(this).attr('data-lng'));

					if($(this).attr('data-center-lat'))
						centerlat = Number($(this).attr('data-center-lat'));
					if($(this).attr('data-center-lng'))
						centerlng = Number($(this).attr('data-center-lng'));

					markerName = $(this).attr('data-marker');
					markers = $(this).attr('data-markers');



					mapId = String($(this).attr('data-mapid'));
					if (mapId.length == 0)
						mapId = 'Map' + key;

					$(this).append('<div class="Map" id="' + mapId + '"></div>');

					isDraggable = false;
					if (!$('body').hasClass('phoneJS'))
						isDraggable = true;

					mapStyle = [{
						"stylers": [{
							"saturation": -100
						}]
					}];
					markerCenter = new google.maps.LatLng({
						lat: lat,
						lng: lng
					});
					mapCenter = new google.maps.LatLng({
						lat: centerlat,
						lng: centerlng
					});


					if (mapId == 'MapLocation') {
						myOptions = {
							zoom: 14,
							center: mapCenter,
							draggable: isDraggable,
							scrollwheel: true,
							mapTypeControl: true,
							panControl: true,
							fullscreenControl: true,
							zoomControl: true,
							zoomControlOptions: {
								position: google.maps.ControlPosition.RIGHT_BOTTOM
							},
							scaleControl: true,
							rotateControl: true,
							streetViewControl: true,
							overviewMapControl: true,
							mapTypeControlOptions: {
								mapTypeIds: ['Mapa', google.maps.MapTypeId.SATELLITE],
								position: google.maps.ControlPosition.LEFT_BOTTOM
							},
							mapTypeId: 'Mapa'
						}
					} else {
						myOptions = {
							zoom: 13,
							center: mapCenter,
							draggable: isDraggable,
							scrollwheel: true,
							mapTypeControl: true,
							panControl: true,
							fullscreenControl: false,
							zoomControl: true,
							zoomControlOptions: {
								position: google.maps.ControlPosition.RIGHT_BOTTOM
							},
							scaleControl: true,
							rotateControl: true,
							streetViewControl: true,
							overviewMapControl: true,
							mapTypeControlOptions: {
								mapTypeIds: [],
								position: google.maps.ControlPosition.LEFT_BOTTOM
							},
							mapTypeId: 'Mapa'
						}
					}
					if ($('body').hasClass('phoneJS')) {
						myOptions = {
							zoom: 13,
							center: mapCenter,
							draggable: isDraggable,
							scrollwheel: true,
							mapTypeControl: true,
							panControl: false,
							fullscreenControl: false,
							zoomControl: true,
							zoomControlOptions: {
								position: google.maps.ControlPosition.RIGHT_BOTTOM
							},
							scaleControl: true,
							rotateControl: true,
							streetViewControl: false,
							overviewMapControl: true,
							mapTypeControlOptions: {
								mapTypeIds: [],
								position: google.maps.ControlPosition.LEFT_BOTTOM
							},
							mapTypeId: 'Mapa'
						}
					}


					mapArray[key] = new google.maps.Map(document.getElementById(mapId), myOptions);
					customMapType = new google.maps.StyledMapType(mapStyle, {
						name: 'Mapa'
					});
					mapArray[key].mapTypes.set('Mapa', customMapType);


					google.maps.event.addListener(mapArray[key], 'zoom_changed', function (e) {
						markers = $(mapArray[key]['__gm']['W'].closest('.MapContainer')).attr('data-markers');
						if (markers)
							refreshMarkers(markers, mapArray[key]);
					})

					if (markers)
						refreshMarkers(markers, mapArray[key]);

					function refreshMarkers(markers, mapObj) {
						if (markersArray)
							for (i in markersArray) {
								markersArray[i].setMap(null);
							}
						markersArray = [];


						markersData = JSON.parse(markers)
						$.each(markersData, function (name, value) {
							latSplit = value['latlng'];
							latSplit = latSplit.split(',');
							latLng = new google.maps.LatLng(latSplit[0], latSplit[1]);

							sizePref = '';
							size = 22;
							if(mapObj.getZoom() > 13){
								sizePref = 'X2';
								size = 34;
							}
							image = {
								url: domainTemplate + '/img/'+value['pin']+sizePref+'.png',
								size: new google.maps.Size(size, size),
								origin: new google.maps.Point(0, 0),
								anchor: new google.maps.Point((size/2), (size/2))
							}

							marker = new google.maps.Marker({
								position: latLng,
								icon: image,
								info_title: name,
								info_distance: value['distance']
							});
							marker.setMap(mapArray[key]);
							markersArray.push(marker);

							google.maps.event.addListener(marker, 'mouseover', function () {
								$('.infoBox').remove();

								infobox = new InfoBox({
									content: '<div class="infoBoxInside"><div class="White"><div class="Name">' + this.info_title + '</div><div class="Distance">' + this.info_distance + '</div></div></div>',
									disableAutoPan: false,
									width: 300,
									zIndex: null,
									infoBoxClearance: new google.maps.Size(1, 1)
								});
								infobox.open(mapArray[key], this);
							});

							google.maps.event.addListener(marker, 'mouseout', function () {
								$('.infoBox').remove();
							});
						})
					}



					if (mapId == 'MapLocation') {
						directionsDisplay = new google.maps.DirectionsRenderer();
						directionsDisplay.setMap(mapArray[key]);
						directionsDisplay.setOptions({
							draggable: false,
							suppressMarkers: true
						});
					}

					if (markerName == 'Logo') {
						image = {
							url: domainTemplate + '/img/PinLogo.png',
							size: new google.maps.Size(39, 54),
							origin: new google.maps.Point(0, 0),
							anchor: new google.maps.Point(0, 54)
						}
					}
					if (markerName == 'Avalon') {
						image = {
							url: domainTemplate + '/img/PinAvalon.png?3',
							size: new google.maps.Size(39, 54),
							origin: new google.maps.Point(0, 0),
							anchor: new google.maps.Point(0, 54)
						}
					}
					if (markerName == 'Default') {
						image = {
							url: domainTemplate + '/img/PinDefault.png?3',
							size: new google.maps.Size(39, 54),
							origin: new google.maps.Point(0, 0),
							anchor: new google.maps.Point(0, 54)
						}
					}

					marker = new google.maps.Marker({
						position: markerCenter,
						icon: image,
						animation: google.maps.Animation.DROP
					});
					marker.setMap(mapArray[key]);

					markerArray.push(marker);

					marker.setAnimation(google.maps.Animation.BOUNCE);
					funcMarkerStop(marker);

					function funcMarkerStop(markerOne) {
						if (markerOne.animating) {
							markerOne.setAnimation(null);
						}
					}
				})

			},
			PageFunction: function (start) {

			},
			init: function () {
				self.Render();
				self.LoadPage();
			}

		});
		this.init();
	}

	ControlPack = new Control();


	$(window).resize(function () {
		$('body').addClass('resize')
		setTimeout(function () {
			$('body').removeClass('resize')
		}, 400);

		ControlPack.Render();
		ControlPack.SlidersPos();
		ControlPack.MapEffect('center');
	});


	History.Adapter.bind(window, 'statechange', function () {
		State = History.getState();

		$('#Menu .Step2 .Links a').each(function (key, value) {
			if ($(value).attr('href') == State.url) {
				dataContent = $(value).attr('data-content');
				dataTemplate = $(value).attr('data-template');
				ControlPack.PageTransition(dataContent, dataTemplate);
			}
		})
	});




	$(document).on('click', ".changePage:not('.off')", function (event) {
		contentActual = $(this).attr('data-content')
		$('body').attr('data-content-actual', contentActual);

		if (contentActual != 'strona-glowna') {

			t = 0;
			if ($('body').attr('data-content') == 'strona-glowna')
				t = 1000;

			setTimeout(function () {
				$('body').removeClass('menuOpen');
				$('body').addClass('menuClose');

				setTimeout(function () {
					$('body').removeClass('menuClose');
				}, 400);
			}, t);
		}

		// Reset

		setTimeout(function () {
			$('.Page.Contact input').removeClass('Error');
			$('.Page.Contact textarea').removeClass('Error');

			$('.Page.Contact input, .Page.Contact textarea').each(function () {
				dataPlaceHolder = $(this).attr('data-placeholder');
				$(this).attr('placeholder', dataPlaceHolder);
			});

			$('.Page.Gallery .View.Mosaic .Items').attr('data-pos', 0)
			$('.Page.Gallery .View.Full .Items').attr('data-pos', 0)
			ControlPack.SlidersPos();
		}, 1500);

		dataHref = $(this).attr('href');
		$.ajax({
			url: domainTemplate + '/action/page_title.php',
			data: {
				url: dataHref
			}
		}).done(function (msg) {
			$('head title').html(msg)

			History.pushState({
				rand: Math.random()
			}, msg, dataHref);
		});

		return false;
	});
});
